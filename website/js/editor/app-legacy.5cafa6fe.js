(function(){"use strict";var e={5968:function(e,t,n){n(6992),n(8674),n(9601),n(7727);var a=n(1357),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor",attrs:{id:"editor"}},[n("EntryDisplay")],1)},r=[],s=n(5200),o=n(2032),l=n(4367),m=(n(8309),n(7941),n(1249),n(9720),n(6699),n(2023),n(463)),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.state.entry.dictConfigs&&e.state.entry.dictConfigs.xemplate?n("div",[n("ComponentGeneratorComponent",{attrs:{children:e.preparedDataForEntry,content:e.dataStructure},on:{input:e.handleContentUpdate}})],1):e._e()},u=[],d=(n(9600),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.renderedChildren,(function(t){return n("ul",{key:t.name},[e.useExampleEngine(t.name)?n("CorpusComponent",{attrs:{"element-name":t.name},on:{save:function(n){return e.saveFromCorpus(t,n)}}}):e._e(),e._l(t.children,(function(t){return n(t.componentName,e._b({key:t.props.key,ref:t.props.elementName+t.props.editorChildNumber,refInFor:!0,tag:"component",class:{"is-attribute":t.props.isAttribute},staticStyle:{display:"list-item"},on:{input:e.handleChildUpdate,"create-element":e.createElement,"move-element":e.moveElement,"delete-element":e.deleteElement,"clone-element":e.createElement}},"component",t.props,!1))}))],2)})),0)}),p=[],h=n(9726),f=(n(9653),n(7327),n(1539),n(561),n(4747),n(9826),n(2222),function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isAnyCorpusAvailable?n("div",{staticClass:"corpus-managers"},[n("div",{ref:"corpusManagers",staticClass:"dropdown",on:{click:e.openCorpuses}},[n("button",{class:{active:e.show}},[e.numberOfCorpuses>1?n("i",{staticClass:"material-icons right"},[e._v("arrow_drop_down")]):e._e(),n("p",[e._v("Corpus search")])]),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},[e.kontextEnabled?n("button",{staticClass:"tertiary",on:{click:e.openKontext}},[e._v("KonText")]):e._e(),e.isSkeAvailable&1===e.numberOfSkeCorpuses?n("button",{staticClass:"tertiary",on:{click:e.openSketchEngine}},[e._v("Sketch Engine")]):e._e(),e.numberOfSkeCorpuses>1&&e.skeXamplEnabled?n("button",{staticClass:"tertiary",on:{click:function(t){return e.openSketchEngine("xampl")}}},[e._v("Ske - Examples")]):e._e(),e.numberOfSkeCorpuses>1&&e.skeCollxEnabled?n("button",{staticClass:"tertiary",on:{click:function(t){return e.openSketchEngine("collx")}}},[e._v("Ske - Collocations")]):e._e(),e.numberOfSkeCorpuses>1&&e.skeDefoEnabled?n("button",{staticClass:"tertiary",on:{click:function(t){return e.openSketchEngine("defo")}}},[e._v("Ske - Definitions")]):e._e(),e.numberOfSkeCorpuses>1&&e.skeThesEnabled?n("button",{staticClass:"tertiary",on:{click:function(t){return e.openSketchEngine("thes")}}},[e._v("Ske - Thesauruses")]):e._e()])]),n("KontextDisplay",{on:{save:function(t){return e.$emit("save",t)}},model:{value:e.showKontext,callback:function(t){e.showKontext=t},expression:"showKontext"}}),n("SkeDisplay",{attrs:{"search-type":e.skeSearchType},on:{save:function(t){return e.$emit("save",t)}},model:{value:e.showSke,callback:function(t){e.showSke=t},expression:"showSke"}})],1):e._e()}),v=[],g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("PopupDisplay",{attrs:{"z-index":"10",value:e.value},on:{input:function(t){return e.$emit("input",t)}}},[n("h2",[e._v("Kontext search engine")]),n("div",{staticClass:"search-box"},[n("div",{staticClass:"switch type-toggle"},[n("label",[e._v(" Headword "),n("input",{ref:"searchTypeToggle",attrs:{type:"checkbox"}}),n("span",{staticClass:"lever"}),e._v(" CQL ")])]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],attrs:{placeholder:"Headword",type:"text"},domProps:{value:e.searchTerm},on:{input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}}),n("button",{on:{click:function(t){return e.getExamples(1)}}},[e._v("Search")])]),e.error?n("div",[e._v(" "+e._s(e.errorMessage)+" ")]):n("div",{staticClass:"examples"},e._l(e.examples,(function(t,a){return n("div",{key:t.text,staticClass:"example",on:{click:function(t){return e.toggleCheck(a)}}},[n("input",{attrs:{type:"checkbox"},domProps:{checked:t.checked}}),n("span",{staticClass:"text--xs",staticStyle:{"font-size":"12px","line-height":"16px"},domProps:{innerHTML:e._s(t.text)}})])})),0),n("div",{staticClass:"navigation"},[e.showPreviousButton?n("button",{staticClass:"tertiary",on:{click:function(t){return e.getExamples(e.pagination.prevPage)}}},[e._v("Previous")]):e._e(),e.showNextButton?n("button",{staticClass:"tertiary",on:{click:function(t){return e.getExamples(e.pagination.nextPage)}}},[e._v("Next")]):e._e()]),n("div",{staticClass:"actions"},[n("button",{on:{click:function(t){return e.$emit("input",!1)}}},[e._v("Cancel")]),n("button",{attrs:{disabled:!e.isAnyExampleChecked},on:{click:e.saveSelectedExamples}},[e._v("Save "+e._s(e.examples.filter((function(e){return e.checked})).length||"")+" ")])])])},y=[],C=(n(4916),n(5306),function(){var e=this,t=e.$createElement,n=e._self._c||t;return!e.keepAlive&&e.value?n("div",{ref:"wrapper",staticClass:"modal",style:e.computedStyles,on:{click:e.maybeClosePopup}},[n("div",{ref:"modalContent",staticClass:"modal-content"},[n("span",{staticClass:"close",on:{click:e.closePopup}},[e._v("×")]),e._t("default")],2)]):e.keepAlive?n("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],ref:"wrapper",staticClass:"modal",style:e.computedStyles,on:{click:e.maybeClosePopup}},[n("div",{ref:"modalContent",staticClass:"modal-content"},[n("span",{staticClass:"close",on:{click:e.closePopup}},[e._v("×")]),e._t("default")],2)]):e._e()}),b=[],x={name:"PopupDisplayComponent",inject:["$validator"],props:{value:{type:Boolean,required:!0},zIndex:{type:String,default:"2"},keepAlive:{type:Boolean,default:!1}},watch:{value:{handler:function(e){e&&(this.popupId||(this.popupId=Math.random()),this.state.openedPopups.push(this.popupId),document.addEventListener("keydown",this.handleEscKey))},immediate:!0}},computed:{computedStyles:function(){return{zIndex:this.zIndex}}},data:function(){return{popupId:null}},methods:{maybeClosePopup:function(e){e.target===this.$refs.wrapper&&this.closePopup()},closePopup:function(){this.$emit("input",!1)},handleEscKey:function(e){var t=this;"Escape"===e.key&&this.$nextTick((function(){t.state.openedPopups[t.state.openedPopups.length-1]===t.popupId&&(document.removeEventListener("keydown",t.handleEscKey),t.closePopup(),t.state.openedPopups.pop())}))}}},E=x,N=n(1001),w=(0,N.Z)(E,C,b,!1,null,"79ba3890",null),k=w.exports,_=n(6166),O=n.n(_),S={name:"KontextDisplay",components:{PopupDisplay:k},props:{value:{type:Boolean,required:!0},zIndex:{type:String,default:"2"}},watch:{"state.headwordData":{handler:function(e){this.searchTerm=e},immediate:!0}},computed:{isAnyExampleChecked:function(){return this.examples.filter((function(e){return e.checked})).length>0}},data:function(){return{searchTerm:"",examples:[],error:!1,errorMessage:"",showPreviousButton:!1,showNextButton:!1,pagination:{}}},methods:{saveSelectedExamples:function(){var e=this.examples.filter((function(e){return e.checked}));this.$emit("save",{type:"kontext",elements:e}),this.$emit("input",!1)},toggleCheck:function(e){this.examples[e].checked=!this.examples[e].checked},getExamples:function(e){var t=this,n="".concat(window.location.origin,"/").concat(this.state.entry.dictId,"/kontext/conc/"),a=this.$refs.searchTypeToggle.checked?"kontextcql":"kontextsimple";O().get(n,{params:{querytype:a,query:this.searchTerm,fromp:e}}).then((function(e){if(e.data.error&&"Empty result"===e.data.error||e.data.Lines&&0===e.data.Lines.length)t.error=!0,t.errorMessage="No results found.";else if(e.data.Lines){var n=e.data.Lines;t.error=!1,t.showPreviousButton=!!e.data.pagination.prevPage,t.showNextButton=!!e.data.pagination.nextPage,t.pagination=e.data.pagination,t.examples=[];for(var a=0;a<n.length;a++){for(var i=n[a],r="",s=0;s<i.Left.length;s++)r+=i.Left[s].str;r=r.replace(/<[^<>]+>/g,"");var o="";for(s=0;s<i.Kwic.length;s++)o+=i.Kwic[s].str;o=o.replace(/<[^<>]+>/g,"");var l="";for(s=0;s<i.Right.length;s++)l+=i.Right[s].str;l=l.replace(/<[^<>]+>/g,"");var m=r+"<b>"+o+"</b>"+l;m=m.replace("<b> "," <b>"),m=m.replace(" </b>","</b> "),t.examples.push({checked:!1,text:m,left:r,headword:o,right:l})}}else t.error=!0,t.errorMessage="There has been an error getting data from KonText."}))}}},D=S,P=(0,N.Z)(D,g,y,!1,null,"5b34d9b8",null),T=P.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("PopupDisplay",{attrs:{"z-index":"10",value:e.value},on:{input:function(t){return e.$emit("input",t)}}},[n("h2",[e._v("Sketch Engine:"+e._s(e.displayedType)+" search")]),n("div",{staticClass:"search-box"},["xampl"===e.searchType?n("div",{staticClass:"switch type-toggle"},[n("label",[e._v(" Headword "),n("input",{ref:"searchTypeToggle",attrs:{type:"checkbox"}}),n("span",{staticClass:"lever"}),e._v(" CQL ")])]):e._e(),n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],attrs:{placeholder:"Headword",type:"text"},domProps:{value:e.searchTerm},on:{input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}}),n("button",{on:{click:function(t){return e.getExamples(1)}}},[e._v("Search")])]),e.error?n("div",[e._v(" "+e._s(e.errorMessage)+" ")]):n("div",{staticClass:"examples"},e._l(e.examples,(function(t,a){return n("div",{key:t.text+a,staticClass:"example",on:{click:function(t){return e.toggleCheck(a)}}},[n("input",{attrs:{type:"checkbox"},domProps:{checked:t.checked}}),n("span",{staticClass:"text--xs",staticStyle:{"font-size":"12px","line-height":"16px"},domProps:{innerHTML:e._s(t.text)}})])})),0),n("div",{staticClass:"navigation"},[e.showPreviousButton?n("button",{staticClass:"tertiary",on:{click:function(t){return e.getExamples(e.pagination.prevPage)}}},[e._v("Previous")]):e._e(),e.showNextButton?n("button",{staticClass:"tertiary",on:{click:function(t){return e.getExamples(e.pagination.nextPage)}}},[e._v("Next")]):e._e()]),n("div",{staticClass:"actions"},[n("button",{on:{click:function(t){return e.$emit("input",!1)}}},[e._v("Cancel")]),n("button",{attrs:{disabled:!e.isAnyExampleChecked},on:{click:e.saveSelectedExamples}},[e._v("Save "+e._s(e.examples.filter((function(e){return e.checked})).length||"")+" ")])])])},I=[],$={name:"SkeDisplay",components:{PopupDisplay:k},props:{value:{type:Boolean,required:!0},zIndex:{type:String,default:"2"},searchType:{type:String}},watch:{"state.headwordData":{handler:function(e){this.searchTerm=e},immediate:!0}},computed:{isAnyExampleChecked:function(){return this.examples.filter((function(e){return e.checked})).length>0},displayedType:function(){switch(this.searchType){case"xampl":return" Examples";case"collx":return" Collocations";case"thes":return" Thesaurus";case"defo":return" Definitions";default:return""}}},data:function(){return{searchTerm:"",examples:[],error:!1,errorMessage:"",showPreviousButton:!1,showNextButton:!1,pagination:{}}},methods:{saveSelectedExamples:function(){var e=this.examples.filter((function(e){return e.checked}));this.$emit("save",{type:this.searchType,elements:e}),this.$emit("input",!1)},toggleCheck:function(e){this.examples[e].checked=!this.examples[e].checked},getExamples:function(e){var t=this,n=this.state.entry.dictConfigs.kex,a="".concat(window.location.origin,"/").concat(this.state.entry.dictId,"/skeget/").concat(this.searchType,"/"),i=this.$refs.searchTypeToggle&&this.$refs.searchTypeToggle.checked?"skecql":"skesimple",r={url:n.apiurl,corpus:n.corpus,username:this.state.entry.userInfo.ske_username,apikey:this.state.entry.userInfo.ske_apiKey,querytype:i,fromp:e};switch(this.searchType){case"xampl":r.query=this.searchTerm;break;case"collx":case"thes":case"defo":r.lemma=this.searchTerm;break}O().get(a,{params:r}).then((function(e){switch((e.data.error&&"Empty result"===e.data.error||e.data.Lines&&0===e.data.Lines.length)&&(t.error=!0,t.errorMessage="No results found."),t.examples=[],t.searchType){case"xampl":t.prepareExamples(e.data);break;case"collx":t.prepareCollocations(e.data);break;case"thes":t.prepareThesaurus(e.data);break;case"defo":t.prepareDefinitions(e.data);break}})).catch((function(e){alert("Something went wrong with SketchEngine, make sure your credentials are correct. "+e.message)}))},prepareThesaurus:function(e){if(e.Words){var t=e.Words;this.error=!1,this.showPreviousButton=!!e.prevlink,this.showNextButton=!!e.nextlink,this.pagination={prevPage:e.prevLink,nextPage:e.nextLink},this.examples=[];for(var n=0;n<t.length;n++){var a=t[n],i=a.word;this.examples.push({checked:!1,text:i})}}else this.error=!0,this.errorMessage="There has been an error getting data from KonText."},prepareCollocations:function(e){if(e.Items){var t=e.Items;this.error=!1,this.showPreviousButton=!!e.prevlink,this.showNextButton=!!e.nextlink,this.pagination={prevPage:e.prevLink,nextPage:e.nextLink},this.examples=[];for(var n=0;n<t.length;n++){var a=t[n],i=a.word;this.examples.push({checked:!1,text:i})}}else this.error=!0,this.errorMessage="There has been an error getting data from KonText."},prepareExamples:function(e){if(e.Lines){var t=e.Lines;this.error=!1,this.showPreviousButton=!!e.prevlink,this.showNextButton=!!e.nextlink,this.pagination={prevPage:e.prevLink,nextPage:e.nextLink},this.examples=[];for(var n=0;n<t.length;n++){for(var a=t[n],i="",r=0;r<a.Left.length;r++)i+=a.Left[r].str;i=i.replace(/<[^<>]+>/g,"");for(var s="",o=0;o<a.Kwic.length;o++)s+=a.Kwic[o].str;s=s.replace(/<[^<>]+>/g,"");for(var l="",m=0;m<a.Right.length;m++)l+=a.Right[m].str;l=l.replace(/<[^<>]+>/g,"");var c=i+"<b>"+s+"</b>"+l;c=c.replace("<b> "," <b>"),c=c.replace(" </b>","</b> "),this.examples.push({checked:!1,text:c,left:i,headword:s,right:l})}}else this.error=!0,this.errorMessage="There has been an error getting data from KonText."},prepareDefinitions:function(e){if(e.Lines){var t=e.Lines;this.error=!1,this.showPreviousButton=!!e.prevlink,this.showNextButton=!!e.nextlink,this.pagination={prevPage:e.prevLink,nextPage:e.nextLink},this.examples=[];for(var n=0;n<t.length;n++){for(var a=t[n],i="",r=0;r<a.Left.length;r++)i+=a.Left[r].str;i=i.replace(/<[^<>]+>/g,"");for(var s="",o=0;o<a.Kwic.length;o++)s+=a.Kwic[o].str;s=s.replace(/<[^<>]+>/g,"");for(var l="",m=0;m<a.Right.length;m++)l+=a.Right[m].str;l=l.replace(/<[^<>]+>/g,"");var c=i+"<b>"+s+"</b>"+l;c=c.replace("<b> "," <b>"),c=c.replace(" </b>","</b> "),this.examples.push({checked:!1,text:c})}}else this.error=!0,this.errorMessage="There has been an error getting data from KonText."}}},j=$,R=(0,N.Z)(j,A,I,!1,null,"3e9b4738",null),Z=R.exports,L={name:"CorpusComponent",components:{SkeDisplay:Z,KontextDisplay:T},props:{elementName:{type:String,required:!0}},computed:{isAnyCorpusAvailable:function(){return this.kontextEnabled||this.isSkeAvailable},skeConfig:function(){return this.state.entry.dictConfigs.kex},isSkeConfigValid:function(){return!!(this.skeConfig.corpus&&this.skeConfig.apiurl&&this.skeConfig.url)},isSkeAvailable:function(){return this.skeXamplEnabled||this.skeCollxEnabled||this.skeThesEnabled||this.skeDefoEnabled},skeXamplEnabled:function(){var e=this.state.entry.dictConfigs.xampl;return!!(this.isSkeConfigValid&&e.container&&e.container===this.elementName&&e.markup)},skeCollxEnabled:function(){var e=this.state.entry.dictConfigs.collx;return!(!this.isSkeConfigValid||!e.container||e.container!==this.elementName)},skeThesEnabled:function(){var e=this.state.entry.dictConfigs.thes;return!(!this.isSkeConfigValid||!e.container||e.container!==this.elementName)},skeDefoEnabled:function(){var e=this.state.entry.dictConfigs.defo;return!(!this.isSkeConfigValid||!e.container||e.container!==this.elementName)},kontextEnabled:function(){var e=this.state.entry.dictConfigs.kontext;return!!(e.container&&e.container===this.elementName&&e.markup&&e.url)},numberOfCorpuses:function(){return[this.kontextEnabled,this.skeDefoEnabled,this.skeThesEnabled,this.skeCollxEnabled,this.skeXamplEnabled].filter((function(e){return!0===e})).length},numberOfSkeCorpuses:function(){return[this.skeDefoEnabled,this.skeThesEnabled,this.skeCollxEnabled,this.skeXamplEnabled].filter((function(e){return!0===e})).length}},watch:{show:function(e){e?window.addEventListener("click",this.watchForOutsideClick):window.removeEventListener("click",this.watchForOutsideClick)}},data:function(){return{show:!1,showKontext:!1,showSke:!1,skeSearchType:"xampl"}},methods:{toggleShow:function(){this.show=!this.show},openCorpuses:function(){1===this.numberOfCorpuses?this.kontextEnabled?this.openKontext():this.isSkeAvailable&&this.openSketchEngine():this.toggleShow()},openKontext:function(){this.showKontext=!0},openSketchEngine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.skeXamplEnabled&&(this.skeSearchType="xampl"),this.skeCollxEnabled&&(this.skeSearchType="collx"),this.skeThesEnabled&&(this.skeSearchType="thes"),this.skeDefoEnabled&&(this.skeSearchType="defo"),e&&(this.skeSearchType=e),this.showSke=!0},watchForOutsideClick:function(e){this.$refs.corpusManagers&&!this.$refs.corpusManagers.contains(e.target)&&this.toggleShow()}}},B=L,V=(0,N.Z)(B,f,v,!1,null,"3276fe69",null),F=V.exports,K={methods:{saveFromCorpus:function(e,t){switch(t.type){case"kontext":this.saveFromKontext(e,t.elements);break;case"collx":case"thes":this.saveSingleWord(e,t.elements);break;case"defo":this.saveDefinitions(e,t.elements);break;case"xampl":this.saveSkeExamples(e,t.elements);break}},saveFromKontext:function(e,t){var n,a=(0,o.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value,r=this.createElementTemplate(e.name)[0],s=this.createElementTemplate(this.state.entry.dictConfigs.kontext.markup)[0];s.elements=[{type:"text",text:i.headword}],r.elements=[{type:"text",text:i.left},s,{type:"text",text:i.right}],this.createElement({name:e.name,content:r})}}catch(l){a.e(l)}finally{a.f()}},saveDefinitions:function(e,t){console.log("saveDefinitions",e,t)},saveSingleWord:function(e,t){var n,a=(0,o.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value,r=this.createElementTemplate(e.name)[0];r.elements=[{type:"text",text:i.text}],this.createElement({name:e.name,content:r})}}catch(s){a.e(s)}finally{a.f()}},saveSkeExamples:function(e,t){var n,a=(0,o.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value,r=this.createElementTemplate(e.name)[0],s=this.createElementTemplate(this.state.entry.dictConfigs.xampl.markup)[0];s.elements=[{type:"text",text:i.headword}],r.elements=[{type:"text",text:i.left},s,{type:"text",text:i.right}],this.createElement({name:e.name,content:r})}}catch(l){a.e(l)}finally{a.f()}}}},U={name:"ComponentGeneratorComponent",inject:["$validator"],components:{CorpusComponent:F},props:{children:Array,elementName:String,content:{type:[Object,Array],required:!0},forceReadOnlyElements:{type:Boolean,default:!1},maxDisplayedChildren:{type:Number,default:-1}},mixins:[K],data:function(){return{displayTypeToComponentMap:{popup:"PopupComponent",inline:"InlineComponent","read-only":"ReadOnlyComponent","text-input":"TextInputComponent",dropdown:"DropdownComponent",media:"MediaComponent"},renderedChildren:[],numberOfRenderedChildren:0,actualContent:{}}},watch:{content:{handler:function(e){this.updateContentInChildren(e)},deep:!0}},created:function(){this.loadNewData(this.content)},methods:{useExampleEngine:function(){return!this.forceReadOnlyElements},getEncompassingStyles:function(e){var t=this.state.entry.dictConfigs.xemplate[e].gutter,n="none";switch(t){case"disk":n="disc";break;case"square":n="square";break;case"diamond":case"arrow":case"handing":break;case"indent":return{marginLeft:"40px"};case"sensenum0":n="upper-roman";break;case"sensenum1":n="decimal";break;case"sensenum2":n="lower-alpha";break;case"sensenum3":n="lower-roman";break}return{listStyleType:n,listStylePosition:"inside",textAlign:"left"}},updateContentInChildren:function(e){var t=this;if(e&&(e.elements||e.attributes)){var n,a=(0,o.Z)(this.renderedChildren);try{var i=function(){var a=n.value,i=void 0;if(a.children[0].props.isAttribute?e.attributes&&(i=[{type:"attribute",name:a.name,text:e.attributes[a.name]}]):e.elements&&(i=e.elements.filter((function(e){return e.name===a.name}))),i.length!==a.children.length)return t.loadNewData(e),{v:void 0};var r=[],s=function(e){var n=a.children[e],s=t.$refs[n.props.elementName+n.props.editorChildNumber],o=s&&s[0]||null,l=void 0;l=i.length!==a.children.length?i.find((function(e){return e._index===n.props.editorChildNumber})):i[n.props.editorChildNumber],o&&l&&o.updateContent(l),o&&!l&&r.push(Number(e))};for(var o in a.children)s(o);if(r.length>0){while(r.length>0){var l=r.pop();a.children.splice(l,1)}a.children.forEach((function(e,t){e.props.editorChildNumber=t}))}};for(a.s();!(n=a.n()).done;){var r=i();if("object"===(0,h.Z)(r))return r.v}}catch(s){a.e(s)}finally{a.f()}}},loadNewData:function(e){var t=this;if(this.renderedChildren=[],this.numberOfRenderedChildren=0,this.children){var n,a=(0,o.Z)(this.children);try{var i=function(){var a=n.value;if(t.numberOfRenderedChildren===t.maxDisplayedChildren)return"break";var i=a.name,r=t.getElementData(i,t.elementName,a.isAttribute);t.state.entry.dictConfigs.xemplate[i]=r;var s=t.getComponentFromElementName(i,a.isAttribute),o=[{}];if(a.isAttribute){var l=e.attributes&&e.attributes[i];o=[{type:"attribute",name:i,text:l}]}else Array.isArray(e&&e.elements)&&(o=e.elements.filter((function(e){return e.name===i})),0===o.length&&(o=[{}]));var m=[];if(Array.isArray(o))for(var c in o){var u=o[c];if(m.push({componentName:s,props:{elementName:i,children:t.getElementChildren(i,u),content:u,elementData:r,editorChildNumber:Number(c),parentElementName:t.elementName,numberOfElements:o.length,isAttribute:a.isAttribute,forceReadOnlyElements:t.forceReadOnlyElements,key:Math.random()}}),t.numberOfRenderedChildren++,t.numberOfRenderedChildren===t.maxDisplayedChildren)break}else if(m.push({componentName:s,props:{elementName:i,children:t.getElementChildren(i,o),content:o,elementData:r,editorChildNumber:0,parentElementName:t.elementName,numberOfElements:o.length,isAttribute:a.isAttribute,forceReadOnlyElements:t.forceReadOnlyElements,key:Math.random()}}),t.numberOfRenderedChildren++,t.numberOfRenderedChildren===t.maxDisplayedChildren)return"break";t.renderedChildren.push({name:i,children:m})};for(a.s();!(n=a.n()).done;){var r=i();if("break"===r)break}}catch(s){a.e(s)}finally{a.f()}}},createElementTemplate:function(e){return(0,m.xml2js)("<".concat(e,"></").concat(e,">"),this.state.xml2jsConfig).elements},getElementChildren:function(e,t){var n=this.state.entry.dictConfigs.xema.elements[e],a=n&&n.children;if(n&&Object.keys(n.attributes||{}).length>0){var i=Object.keys(n.attributes).map((function(e){return{name:e,isAttribute:!0}}));a=i.concat(a)}if(t.elements){var r=t.elements.filter((function(e){return!!e.name})),s=r.map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})).length;if(!n||s!==(n.children&&n.children.length)){var l=[];r&&(l=r.map((function(e){return{min:1,max:1,name:e.name}}))),a=a||[];var m,c=(0,o.Z)(l);try{var u=function(){var e=m.value;a.find((function(t){return t.name===e.name}))||a.push(e)};for(c.s();!(m=c.n()).done;)u()}catch(d){c.e(d)}finally{c.f()}}}return a},getElementData:function(e,t,n){var a,i=this.state.entry.dictConfigs.xemplate;return a=n?i[t].attributes&&i[t].attributes[e]:i[e],a?("shown"in a||(a.shown=!0),"displayType"in a||(a.displayType="inline"),"valueRenderType"in a||(a.valueRenderType="text-input")):a={shown:!0,displayType:"inline",valueRenderType:"text-input"},a},handleChildUpdate:function(e){var t=Object.assign({},this.content);if(e.isAttribute)return t.attributes=(0,l.Z)((0,l.Z)({},t.attributes),e.content),this.$emit("input",{content:t}),!0;if(t.elements){if(!t.elements.find((function(t){return t.name===e.elementName})))return t.elements.push(e.content),void this.$emit("input",{content:t})}else t.elements=this.createElementTemplate(e.elementName);var n=0,a=!1;for(var i in t.elements)if(t.elements[i].name===e.elementName){if(n===e.editorChildNumber){a=!0,t.elements[i]=e.content;break}n++}a||this.appendElementAfterSameNameSiblings(e.elementName,t,e.content),this.$emit("input",{content:t})},getComponentFromElementName:function(e,t,n){if(this.forceReadOnlyElements)return this.displayTypeToComponentMap["inline"];var a,i=this.state.entry.dictConfigs.xemplate;a=n?i[t].attributes&&i[t].attributes[e]:i[e];var r=a&&a.displayType||"inline";return this.displayTypeToComponentMap[r]},appendElementAfterSameNameSiblings:function(e,t,n){var a=t.elements||[],i=a.map((function(e){return e.name})).lastIndexOf(e);i>=0?a.splice(i+1,0,n):a.push(n),t.elements=a,this.loadNewData(t)},createElement:function(e){var t=this.content.elements.filter((function(t){return t.name===e.name})).length;this.handleChildUpdate({elementName:e.name,editorChildNumber:t,content:e.content||this.createElementTemplate(e.name)[0]})},moveElement:function(e){var t=e.name,n=e.direction,a=e.position,i=this.content.elements||[];if(this.isNewPositionInBounds(i,t,a,n)){var r=this.getPositionOfElementInContent(t,a,this.content),s=i[r];i.splice(r,1),i.splice(r+n,0,s);var o=Object.assign({},this.content);o.elements=i,this.loadNewData(o),this.$emit("input",{content:o})}},deleteElement:function(e){var t=e.name,n=e.position,a=this.content.elements||[],i=0,r=-1;for(var s in a)a[s].name===t&&(a[s]._index=i,i===n&&(r=s),i++);if(-1!==r){a.splice(r,1);var o=Object.assign({},this.content);o.elements=a,this.$emit("input",{content:o})}},isNewPositionInBounds:function(e,t,n,a){var i=n+a,r=e.filter((function(e){return e.name===t})).length;return i>=0&&i<r},getPositionOfElementInContent:function(e,t,n){var a,i=n.elements,r=0;for(var s in i)if(i[s].name===e){if(r===t){a=s;break}r++}return Number(a)}}},q=U,W=(0,N.Z)(q,d,p,!1,null,"c0e910fe",null),G=W.exports,H={name:"EntryDisplay",components:{ComponentGeneratorComponent:G},watch:{dirty:function(e){try{e?Screenful.Editor.changed():Screenful.Editor.resetChanged()}catch(t){console.error(t)}}},computed:{preparedDataForEntry:function(){if(!this.state.entry.dictConfigs)return[];var e=this.state.entry.content,t=e.elements&&e.elements[0]&&e.elements[0].name||this.state.entry.dictConfigs.xema.root;return[{max:1,min:1,name:t}]}},data:function(){return{dataStructure:{},dirty:!1}},created:function(){this.dataStructure=this.state.entry.content,window.harvestGraphicalEditorData=this.getXmlData,this.setHeadwordElement()},methods:{setHeadwordElement:function(){var e=this.state.entry.dictConfigs,t=e.titling;if(t&&t.headword)this.state.headwordElement=t.headword;else{var n=e.xema.root;if(n){var a=e.xema.elements[n];a&&a.children&&a.children.length>0&&(this.state.headwordElement=a.children[0].name)}}},handleContentUpdate:function(e){this.dataStructure=e.content,this.dirty=this.areAnyChanges()},areAnyChanges:function(){var e=this.createDeepCopy();this.fixElementNames(e);var t=(0,m.js2xml)(e,this.state.xml2jsConfig),n=(0,m.js2xml)(this.state._initialContent,this.state.xml2jsConfig);return n!=t},getXmlData:function(){var e=this;return this.$validator.validateAll().then((function(t){if(t)return e.prepareXMLData();var n=e.$validator.errors.items.map((function(e){return e.field})).join("\n");return!0===confirm("Are you sure you want to save despite some elements missing? \n \n Missing fields: \n".concat(n))?e.prepareXMLData():null}))},prepareXMLData:function(){var e=this.createDeepCopy();delete e.declaration,this.fixElementNames(e);var t=(0,m.js2xml)(e,this.state.xml2jsConfig);return console.log(t),t},createDeepCopy:function(){var e=(0,m.js2xml)(this.dataStructure,this.state.xml2jsConfig);return(0,m.xml2js)(e,this.state.xml2jsConfig)},fixElementNames:function(e){if(e.name){var t=this.getStructureConfig(e.name);t&&t.elementName&&(e.name=t.elementName)}if(e.attributes)for(var n=0,a=Object.keys(e.attributes);n<a.length;n++){var i=a[n],r=this.getStructureConfig(i,e.name);r&&r.elementName&&(e.attributes[r.elementName]=e.attributes[i],delete e.attributes[i])}if(e.elements){var s,l=(0,o.Z)(e.elements);try{for(l.s();!(s=l.n()).done;){var m=s.value;this.fixElementNames(m)}}catch(c){l.e(c)}finally{l.f()}}},getStructureConfig:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.state.entry.dictConfigs.xema.elements;return n[e]?t?n[t].attributes[e]:n[e]||{}:{}}}},z=H,X=(0,N.Z)(z,c,u,!1,null,"30539e3d",null),J=X.exports,Q=n(1386),Y={name:"App",components:{EntryDisplay:J},props:{message:String},created:function(){var e=window.entryData;this.updateEntry(e),this.addDropdownValidator()},methods:{updateEntry:function(e){e&&(console.log(e.content),this.state._initialContent=(0,m.xml2js)(e.content||"",this.state.xml2jsConfig),e.content=(0,m.xml2js)(e.content||"",this.state.xml2jsConfig),this.changeElementNames(e.content,null,e.dictConfigs.xema),this.state.entry=(0,l.Z)((0,l.Z)({},this.state.entry),e))},changeElementNames:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(e.name&&(e.name=this.getFakeName(e.name,t,n)||e.name),e.attributes)for(var a=0,i=Object.keys(e.attributes);a<i.length;a++){var r=i[a],s=this.getFakeName(r,e.name,n);s&&s!==r&&(e.attributes[s]=e.attributes[r],delete e.attributes[r])}if(e.elements){var l,m=(0,o.Z)(e.elements);try{for(m.s();!(l=m.n()).done;){var c=l.value;this.changeElementNames(c,e.name,n)}}catch(u){m.e(u)}finally{m.f()}}},getFakeName:function(e,t,n){if(n.root===e)return n.elements[e].name;if(!t)return console.error("No parent element"),e;var a=n.elements[t]&&n.elements[t].children||[];t&&(a=a.map((function(e){return e.name})));for(var i=0,r=Object.entries(n.elements);i<r.length;i++){var o=(0,s.Z)(r[i],2),l=o[0],m=o[1];if(m.elementName===e&&a.includes(l))return l}},addDropdownValidator:function(){Q.cX.extend("requiredDropdown",{getMessage:function(e){return"The "+e+" value is required."},validate:function(e){return!("undefined"===typeof e||!e)}})}}},ee=Y,te=(0,N.Z)(ee,i,r,!1,null,null,null),ne=te.exports,ae={entry:{entryId:null,dictId:null,dictConfigs:null,userAccess:null,userInfo:null,editorConfig:null,content:{},contentHtml:null},xml2jsConfig:{compact:!1},_initialContent:null,headwordElement:null,headwordData:null,openedPopups:[]},ie={state:ae},re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"inline-component",class:{"read-only":e.forceReadOnlyElements},style:e.configStyles},[e.elementData.shown&&!e.readOnly?n("section",{staticClass:"content"},[e.isAttribute?e._e():n("ActionButtons",{staticClass:"actions-button",attrs:{elementName:e.elementName,elementEditorConfig:e.elementData,editorChildNumber:e.editorChildNumber,parentElementName:e.parentElementName,numberOfElements:e.numberOfElements},on:{"move-element-down":e.moveElementDown,"move-element-up":e.moveElementUp,"add-element":e.createSibling,"select-new-parent":e.selectNewParent,"clone-element":e.cloneElement,"remove-element":e.deleteElement}}),n(e.valueComponent,{tag:"component",staticClass:"value-display",attrs:{elementEditorConfig:e.elementData,elementName:e.elementName,elementData:e.elementData,content:e.componentData,children:e.children,isAttribute:e.isAttribute,parentElementName:e.parentElementName,forceReadOnly:e.forceReadOnlyElements},on:{"hide-children":e.hideChildren,input:e.handleValueUpdate}})],1):e._e(),e.elementData.shown&&e.readOnly?n("section",[n(e.valueComponent,{tag:"component",attrs:{elementEditorConfig:e.elementData,elementName:e.elementName,elementData:e.elementData,content:e.componentData,children:e.children,isAttribute:e.isAttribute,parentElementName:e.parentElementName,forceReadOnly:e.forceReadOnlyElements},on:{"hide-children":e.hideChildren,input:e.handleValueUpdate}})],1):e._e(),"TextInputWithMarkupComponent"!==e.valueComponent?n("ComponentGeneratorComponent",{attrs:{children:e.children,elementName:e.elementName,content:e.calculatedContent,forceReadOnlyElements:e.forceReadOnlyElements,maxDisplayedChildren:e.maxDisplayedChildren},on:{input:e.handleChildUpdate}}):e._e(),e.showSelectNewParent?n("SelectElementFromArray",{attrs:{"element-name":e.elementName,"possible-parent-elements":e.newPossibleParents,parentElementName:e.parentElementName},on:{"selected-element":e.handleSelectedNewParent},model:{value:e.showSelectNewParent,callback:function(t){e.showSelectNewParent=t},expression:"showSelectNewParent"}}):e._e()],1)},se=[],oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isRootElement?e._e():n("div",{ref:"actionButton",staticClass:"dropdown"},[n("button",{staticClass:"button--sm secondary",attrs:{disabled:0===e.numberOfActions},on:{click:function(t){return t.stopPropagation(),e.toggleDropdown.apply(null,arguments)}}},[e._v(" "+e._s(e.computedElementName)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"vue-dropdown-content"},[e.canMoveElementDown?n("button",{staticClass:"tertiary",on:{click:function(t){return e.triggerEvent("move-element-down")}}},[e._v(" Move "+e._s(e.computedElementName)+" "),n("img",{attrs:{src:e.iconUrl("arrow-down.svg")}})]):e._e(),e.canMoveElementUp?n("button",{staticClass:"tertiary",on:{click:function(t){return e.triggerEvent("move-element-up")}}},[e._v(" Move "+e._s(e.computedElementName)+" "),n("img",{attrs:{src:e.iconUrl("arrow-up.svg")}})]):e._e(),e.canAddElement&&e.elementEditorConfig.enableCopying?n("button",{staticClass:"tertiary",on:{click:function(t){return e.triggerEvent("select-new-parent")}}},[e._v(" Change parent of "+e._s(e.computedElementName)+" ")]):e._e(),e.canAddElement?n("button",{staticClass:"tertiary",on:{click:function(t){return e.triggerEvent("add-element")}}},[e._v(" Create new "+e._s(e.computedElementName)+" ")]):e._e(),e.canAddElement&&e.elementEditorConfig.enableCopying?n("button",{staticClass:"tertiary",on:{click:function(t){return e.triggerEvent("clone-element")}}},[e._v(" Duplicate "+e._s(e.computedElementName)+" ")]):e._e(),e.canRemoveElement?n("button",{staticClass:"tertiary",on:{click:function(t){return e.triggerEvent("remove-element")}}},[e._v(" Remove selected "+e._s(e.computedElementName)+" ")]):e._e()])])},le=[],me={props:{isAttribute:{type:Boolean},parentElementName:{type:String}},computed:{computedElementNameWithColon:function(){if(this.elementData&&this.elementData.hideElementName)return"";var e=this.state.entry.dictConfigs.xema.elements,t=e[this.elementName]&&e[this.elementName].elementName||this.elementName;if(this.isAttribute)try{var n=e[this.parentElementName].attributes[this.elementName].optionality;"obligatory"===n&&(t+="*")}catch(a){console.log("",t)}return t+=":",t},computedElementName:function(){if(this.elementData&&this.elementData.hideElementName)return"";var e=this.state.entry.dictConfigs.xema.elements,t=e[this.elementName]&&e[this.elementName].elementName||this.elementName;if(this.isAttribute)try{var n=e[this.parentElementName].attributes[this.elementName].optionality;"obligatory"===n&&(t+="*")}catch(a){console.log("",t)}return t}}},ce={methods:{iconUrl:function(e){return"".concat(window.location.origin,"/img/svg/").concat(e)}}},ue={name:"ActionButtons",props:{elementName:String,elementEditorConfig:Object,parentElementName:String,numberOfElements:Number,editorChildNumber:Number},mixins:[me,ce],data:function(){return{show:!1}},computed:{isRootElement:function(){return this.elementName===this.state.entry.dictConfigs.xema.root},numberOfActions:function(){return[this.canAddElement,this.canRemoveElement,this.canMoveElementUp,this.canMoveElementDown].filter((function(e){return!0===e})).length},canAddElement:function(){var e=this,t=this.state.entry.dictConfigs.xema.elements,n=t&&t[this.parentElementName]&&t[this.parentElementName].children||[],a=n.find((function(t){return t.name===e.elementName}));return a&&(!a.max||this.numberOfElements<a.max)},canRemoveElement:function(){var e=this,t=this.state.entry.dictConfigs.xema.elements,n=t&&t[this.parentElementName]&&t[this.parentElementName].children||[],a=n.find((function(t){return t.name===e.elementName}));return a&&(!a.min||this.numberOfElements>a.min)},canMoveElementDown:function(){return this.elementEditorConfig.enablePositionChange&&this.editorChildNumber<this.numberOfElements-1},canMoveElementUp:function(){return this.elementEditorConfig.enablePositionChange&&this.editorChildNumber>0}},watch:{show:function(e){e?window.addEventListener("click",this.watchForOutsideClick):window.removeEventListener("click",this.watchForOutsideClick)}},methods:{triggerEvent:function(e){var t=this;this.toggleDropdown(),this.$nextTick((function(){t.$emit(e)}))},toggleDropdown:function(){this.show=!this.show},watchForOutsideClick:function(e){this.$refs.actionButton&&!this.$refs.actionButton.contains(e.target)&&this.toggleDropdown()}}},de=ue,pe=(0,N.Z)(de,oe,le,!1,null,"1aaae324",null),he=pe.exports,fe={data:function(){return{valueComponent:null}},created:function(){var e,t={chd:"ReadOnlyComponent",emp:"ReadOnlyComponent",txt:"TextInputComponent",lst:"DropdownComponent",med:"MediaComponent",inl:"TextInputWithMarkupComponent"};if(this.isAttribute){var n=this.state.entry.dictConfigs.xema.elements[this.parentElementName].attributes||{};e=n[this.elementName]}else e=this.state.entry.dictConfigs.xema.elements[this.elementName];if(e){var a=e.filling;this.valueComponent=t[a]}else console.error("xema config doesn't exists for: ".concat(this.elementName)),this.valueComponent="TextInputComponent"}},ve={mixins:[fe],computed:{configStyles:function(){for(var e={},t=0,n=Object.entries(this.elementData);t<n.length;t++){var a=(0,s.Z)(n[t],2),i=a[0],r=a[1];switch(i){case"border":e.border="1px ".concat(r," #B3D6FF");break}}if(!this.forceReadOnlyElements)return e},readOnly:function(){return this.elementData.readOnly||this.forceReadOnlyElements},componentData:function(){if("TextInputWithMarkupComponent"===this.valueComponent)return this.calculatedContent.elements||[];if(this.isAttribute)return this.calculatedContent||{type:"attribute",name:this.elementName,text:""};var e=this.calculatedContent.elements&&this.calculatedContent.elements.find((function(e){return"text"===e.type&&!e.name}));return e||{text:"",type:"text"}},calculatedContent:function(){return this.updatedContent||this.content}},data:function(){return{showChildren:!0,updatedContent:null,isHeadword:!1,newPossibleParents:[],showSelectNewParent:!1}},created:function(){if(!this.forceReadOnlyElements&&(this.children&&this.children.length>0&&this.bus.$on("is-parent-to-element",this.handleIsParentToElement),this.state.headwordElement===this.elementName)){this.isHeadword=!0;try{this.state.headwordData=this.getHeadwordValue(this.content.elements)}catch(e){console.error(e)}}},beforeDestroy:function(){this.bus.$off("is-parent-to-element",this.handleIsParentToElement),this.bus.$off("possible-new-parent",this.handlePossibleNewParent),this.bus.$off("add-element-to-self",this.addElementToSelf)},methods:{getHeadwordValue:function(e){try{return e.find((function(e){return"text"===e.type})).text}catch(t){return console.error(t),""}},hideChildren:function(){this.showChildren=!1},createElementTemplate:function(e){return(0,m.xml2js)("<".concat(e,"></").concat(e,">"),this.state.xml2jsConfig).elements[0]},handleValueUpdate:function(e){if(this.isAttribute)this.$emit("input",{elementName:this.elementName,content:e.attributes,isAttribute:!0});else{this.isHeadword&&(this.state.headwordData=this.getHeadwordValue(e.elements));var t=Object.assign({},this.calculatedContent);0===Object.keys(t).length&&(t=this.createElementTemplate(this.elementName)),t.elements=e.elements,this.$emit("input",{elementName:this.elementName,editorChildNumber:this.editorChildNumber,content:t})}},handleChildUpdate:function(e){var t=(0,l.Z)((0,l.Z)({},this.calculatedContent),e.content);this.$emit("input",{elementName:this.elementName,editorChildNumber:this.editorChildNumber,content:t})},updateContent:function(e){this.updatedContent=e},moveElementDown:function(){this.$emit("move-element",{name:this.elementName,direction:1,position:this.editorChildNumber})},moveElementUp:function(){this.$emit("move-element",{name:this.elementName,direction:-1,position:this.editorChildNumber})},createSibling:function(){this.$emit("create-element",{name:this.elementName})},deleteElement:function(){this.$emit("delete-element",{name:this.elementName,position:this.editorChildNumber})},cloneElement:function(){this.$emit("clone-element",{name:this.elementName,content:this.calculatedContent})},selectNewParent:function(){var e=this;this.newPossibleParents=[],this.bus.$on("possible-new-parent",this.handlePossibleNewParent),this.bus.$emit("is-parent-to-element",{emitEvent:"possible-new-parent",elementName:this.elementName}),setTimeout((function(){e.showSelectNewParent=!0}),50)},handleSelectedNewParent:function(e){this.bus.$emit("add-element-to-self",{name:e.props.elementName,editorChildNumber:e.props.content.editorChildNumber,content:this.calculatedContent}),this.deleteElement()},addElementToSelf:function(e){if(this.elementName===e.name&&this.editorChildNumber===e.editorChildNumber){var t=Object.assign({},e.content);delete t._index;var n=Object.assign({},this.calculatedContent);if(n.elements){if(!n.elements.find((function(e){return e.name===t.name})))return n.elements.push(t),this.updatedContent=n,void this.handleChildUpdate({content:n})}else n.elements=this.createElementTemplate(t.name);n=this.appendElementAfterSameNameSiblings(t.name,n,t),this.updatedContent=n,this.handleChildUpdate({content:n})}this.bus.$off("add-element-to-self",this.addElementToSelf)},handlePossibleNewParent:function(e){console.log(e),this.newPossibleParents.push(e.content)},handleIsParentToElement:function(e){this.children.find((function(t){return t.name===e.elementName}))&&(this.bus.$emit(e.emitEvent,{content:(0,l.Z)((0,l.Z)({},this.calculatedContent),{parentName:this.parentElementName,editorChildNumber:this.editorChildNumber})}),this.bus.$on("add-element-to-self",this.addElementToSelf))},appendElementAfterSameNameSiblings:function(e,t,n){var a=t.elements||[],i=a.map((function(e){return e.name})).lastIndexOf(e);return i>=0?a.splice(i+1,0,n):a.push(n),t.elements=a,t}}},ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("PopupDisplay",{attrs:{"z-index":e.zIndex,value:e.value},on:{input:function(t){return e.$emit("input",t)}}},[n("h2",[e._v("Move selected "+e._s(e.computedElementName)+" to:")]),n("div",{staticClass:"parents"},[n("ReadOnlyComponentGenerator",{attrs:{children:e.children,elementName:e.elementName,content:e.possibleParentElements},on:{"selected-element":e.handleSelectedElement}})],1),n("div",{staticClass:"actions"},[n("button",{on:{click:function(t){return e.$emit("input",!1)}}},[e._v("Cancel")])])])},ye=[],Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.renderedChildren,(function(t){return n("section",{key:t.props.key,staticClass:"component drop-shadow--100",on:{click:function(n){return e.$emit("selected-element",t)}}},[n(t.componentName,e._b({ref:t.props.elementName+t.props.editorChildNumber,refInFor:!0,tag:"component",class:{"is-attribute":t.props.isAttribute},attrs:{forceReadOnlyElements:!0,"max-displayed-children":5}},"component",t.props,!1))],1)})),0)},be=[],xe={name:"ReadOnlyComponentGenerator",props:{children:Array,elementName:String,content:{type:[Object,Array],required:!0}},data:function(){return{renderedChildren:[]}},watch:{content:{handler:function(e){this.loadNewData(e)},deep:!0}},created:function(){this.loadNewData(this.content)},methods:{loadNewData:function(e){var t=this;this.renderedChildren=[],this.children&&e.forEach((function(e){var n=e.name,a=t.getElementData(n,e.parentName,e.isAttribute);a.hideElementName=!1;var i="InlineComponent",r=e;t.renderedChildren.push({componentName:i,props:{elementName:n,children:t.getElementChildren(n,r),content:r,elementData:a,editorChildNumber:0,parentElementName:t.elementName,numberOfElements:1,isAttribute:e.isAttribute,forceReadOnlyElements:t.forceReadOnlyElements,key:Math.random()}})}))},getElementChildren:function(e,t){var n=this.state.entry.dictConfigs.xema.elements[e],a=n&&n.children;if(n&&Object.keys(n.attributes||{}).length>0){var i=Object.keys(n.attributes).map((function(e){return{name:e,isAttribute:!0}}));a=i.concat(a)}if(t.elements){var r=t.elements.filter((function(e){return!!e.name})),s=r.map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})).length;if(!n||s!==(n.children&&n.children.length)){var l=[];r&&(l=r.map((function(e){return{min:1,max:1,name:e.name}}))),a=a||[];var m,c=(0,o.Z)(l);try{var u=function(){var e=m.value;a.find((function(t){return t.name===e.name}))||a.push(e)};for(c.s();!(m=c.n()).done;)u()}catch(d){c.e(d)}finally{c.f()}}}return a},getElementData:function(e,t,n){var a,i=this.state.entry.dictConfigs.xemplate;return a=n?i[t].attributes&&i[t].attributes[e]:i[e],a?("shown"in a||(a.shown=!0),"displayType"in a||(a.displayType="inline"),"valueRenderType"in a||(a.valueRenderType="text-input")):a={shown:!0,displayType:"inline",valueRenderType:"text-input"},a}}},Ee=xe,Ne=(0,N.Z)(Ee,Ce,be,!1,null,"45e60001",null),we=Ne.exports,ke={name:"SelectElementFromArray",components:{ReadOnlyComponentGenerator:we,PopupDisplay:k},props:{value:{type:Boolean,required:!0},zIndex:{type:String,default:"100"},elementName:{type:String,default:""},possibleParentElements:{type:Array,required:!0}},mixins:[me],computed:{children:function(){return this.possibleParentElements.map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return{name:e}}))}},methods:{handleSelectedElement:function(e){this.$emit("selected-element",e),this.$emit("input",!1)}}},_e=ke,Oe=(0,N.Z)(_e,ge,ye,!1,null,"ab462fea",null),Se=Oe.exports,De={name:"InlineComponent",inject:["$validator"],components:{SelectElementFromArray:Se,ActionButtons:he,ComponentGeneratorComponent:G},mixins:[ve],props:{children:Array,elementData:Object,elementName:String,parentElementName:String,numberOfElements:Number,content:{type:[Object,Array],required:!0},childrenContent:Object,editorChildNumber:Number,isAttribute:Boolean,forceReadOnlyElements:{type:Boolean,default:!1},maxDisplayedChildren:{type:Number,default:-1}}},Pe=De,Te=(0,N.Z)(Pe,re,se,!1,null,"1b801170",null),Ae=Te.exports,Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"popup-component"},[n("div",[e.elementData.shown?n("section",{staticClass:"preview drop-shadow--100",on:{click:e.openPopup}},[e.isAttribute?e._e():n("ActionButtons",{staticClass:"actions-button",attrs:{elementName:e.elementName,elementEditorConfig:e.elementData,editorChildNumber:e.editorChildNumber,parentElementName:e.parentElementName,numberOfElements:e.numberOfElements},on:{"move-element-down":e.moveElementDown,"move-element-up":e.moveElementUp,"add-element":e.createSibling,"clone-element":e.cloneElement,"remove-element":e.deleteElement}}),n("section",[n(e.valueComponent,{tag:"component",staticClass:"preview-element text--md",attrs:{elementEditorConfig:e.elementData,elementName:e.elementName,elementData:e.elementData,content:e.componentData,isAttribute:e.isAttribute,parentElementName:e.parentElementName,forceReadOnlyElements:!0},on:{"hide-children":e.hideChildren,input:e.handleValueUpdate}}),e.showChildren?n("ComponentGeneratorComponent",{staticClass:"preview-components",attrs:{children:e.children,elementName:e.elementName,content:e.calculatedContent,forceReadOnlyElements:!0},on:{input:e.handleChildUpdate}}):e._e()],1)],1):e._e(),n("PopupDisplay",{model:{value:e.showPopup,callback:function(t){e.showPopup=t},expression:"showPopup"}},[e.elementData.shown?n(e.valueComponent,{tag:"component",attrs:{elementEditorConfig:e.elementData,elementName:e.elementName,elementData:e.elementData,content:e.componentData,isAttribute:e.isAttribute,parentElementName:e.parentElementName},on:{"hide-children":e.hideChildren,input:e.handleValueUpdate}}):e._e(),e.showChildren?n("ComponentGeneratorComponent",{attrs:{children:e.children,elementName:e.elementName,content:e.calculatedContent},on:{input:e.handleChildUpdate}}):e._e()],1)],1),e.showSelectNewParent?n("SelectElementFromArray",{attrs:{"element-name":e.elementName,"possible-parent-elements":e.newPossibleParents,parentElementName:e.parentElementName},on:{"selected-element":e.handleSelectedNewParent},model:{value:e.showSelectNewParent,callback:function(t){e.showSelectNewParent=t},expression:"showSelectNewParent"}}):e._e()],1)},$e=[],Me={name:"PopupComponent",inject:["$validator"],components:{ComponentGeneratorComponent:G,ActionButtons:he,PopupDisplay:k,SelectElementFromArray:Se},mixins:[ve],props:{children:Array,elementData:Object,elementName:String,parentElementName:String,numberOfElements:Number,content:{type:[Object,Array],required:!0},editorChildNumber:Number,isAttribute:Boolean,forceReadOnlyElements:{type:Boolean,default:!1}},data:function(){return{showPopup:!1,showChildren:!0,updatedContent:null}},methods:{openPopup:function(){this.showPopup=!0}}},je=Me,Re=(0,N.Z)(je,Ie,$e,!1,null,"63d23c37",null),Ze=Re.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.elementData.shown?n("section",[n("p",{class:e.computedClass},[e._v(e._s(e.forceReadOnly?e.computedElementNameWithColon:"")+" ")]),n("span",{class:e.computedClass},[e._v(" "+e._s(e.content.text))])]):e._e()])},Be=[],Ve={props:{forceReadOnly:{type:Boolean,default:!1}},computed:{computedClass:function(){return this.forceReadOnly?"text--xs":"text--md"},readOnly:function(){return this.elementData.readOnly||this.forceReadOnly}}},Fe={name:"ReadOnlyComponent",props:{children:Array,elementData:Object,elementName:String,content:{type:[Object,Array],required:!0}},mixins:[me,Ve]},Ke=Fe,Ue=(0,N.Z)(Ke,Le,Be,!1,null,"1eafa6d2",null),qe=Ue.exports,We=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.elementData.shown&&!e.readOnly?n("section",{staticClass:"dropdown",class:{error:e.errors.has(e.computedElementName)}},[n("p",{staticClass:"text--md"},[e._v(e._s(e.isAttribute?e.computedElementNameWithColon:""))]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"},{name:"validate",rawName:"v-validate.continues",value:e.computedValidation,expression:"computedValidation",modifiers:{continues:!0}}],attrs:{name:e.computedElementName||e.elementName},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.value=t.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"",disabled:"",selected:""}},[e._v(" Choose "+e._s(this.computedElementName||e.elementName)+" ")]),e._l(e.options,(function(t){return n("option",{key:t.value,domProps:{value:t.value}},[e._v(e._s(t.caption))])}))],2)]):e._e(),e.elementData.shown&&e.readOnly?n("section",{staticClass:"read-only"},[n("p",{class:e.computedClass},[e._v(e._s(e.computedElementNameWithColon)+" ")]),n("span",{class:e.computedClass},[e._v(e._s(e.valueCaption))])]):e._e()])},Ge=[],He=n(3796),ze=(n(3948),{props:{isAttribute:{type:Boolean},parentElementName:{type:String}},computed:{computedValidation:function(){if(!this.parentElementName)return null;if(this.isAttribute){var e=this.state.entry.dictConfigs.xema.elements[this.parentElementName].attributes[this.elementName];if("obligatory"===e.optionality)return"lst"===e.filling?{requiredDropdown:!0}:{required:!0}}return null}}}),Xe={name:"DropdownComponent",inject:["$validator"],props:{elementData:Object,elementName:String,content:{type:Object,required:!0}},mixins:[me,Ve,ze],computed:{valueCaption:function(){var e=this,t=this.options.find((function(t){return t.value===e.value}));return t&&t.caption}},data:function(){return{value:null,options:[]}},watch:{value:function(e){if(e!==this.content.text)if("attribute"===this.content.type)this.$emit("input",{elementName:this.elementName,attributes:(0,He.Z)({},this.content.name,e)});else{var t=Object.assign({},this.content);t.text=e,this.$emit("input",{elementName:this.elementName,elements:[t]})}}},created:function(){var e=this.state.entry.dictConfigs.xema.elements[this.elementName];if(!e){var t=this.state.entry.dictConfigs.xema.elements[this.parentElementName].attributes||{};e=t[this.elementName]}this.options=e.values,this.value=this.content.text},mounted:function(){this.initSelect()},methods:{initSelect:function(){M.FormSelect.init(document.querySelectorAll("select"),{})}}},Je=Xe,Qe=(0,N.Z)(Je,We,Ge,!1,null,"0839600b",null),Ye=Qe.exports,et=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.elementData.shown&&!e.readOnly?n("section",{staticClass:"media-input"},[e.isAttribute?n("label",{staticClass:"text--md",attrs:{for:e.computedElementName}},[e._v(e._s(e.computedElementNameWithColon))]):e._e(),n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{name:e.computedElementName,type:"text"},domProps:{value:e.value},on:{change:e.updateParent,input:function(t){t.target.composing||(e.value=t.target.value)}}}),n("button",{staticClass:"button--sm secondary",staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.$refs.imageSearcher.toggleOpen()}}},[n("img",{attrs:{src:e.iconUrl("search-image.svg")}})])]):e._e(),e.elementData.shown&&!e.readOnly?n("ImageSearcher",{ref:"imageSearcher",on:{selected:e.updateValue}}):e._e(),e.elementData.shown&&e.readOnly?n("section",{staticClass:"read-only"},[n("p",{class:e.computedClass},[e._v(e._s(e.computedElementNameWithColon)+" ")]),n("span",{class:e.computedClass},[e._v(e._s(e.value))])]):e._e()],1)},tt=[],nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"popup"},[n("div",{ref:"wrapper",staticClass:"modal",on:{click:e.maybeClosePopup}},[n("div",{ref:"modalContent",staticClass:"modal-content"},[n("span",{staticClass:"close",on:{click:e.close}},[e._v("×")]),n("div",{staticClass:"search-box"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],attrs:{type:"text",placeholder:"Search images for"},domProps:{value:e.searchTerm},on:{input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}}),n("button",{on:{click:function(t){return e.getImages()}}},[e._v("Search")])]),n("div",{staticClass:"image-carousel"},[e._l(e.images,(function(t,a){return n("div",{key:a,staticClass:"image-holder"},[n("img",{attrs:{src:t.thumb},on:{click:function(n){return e.selectImage(t.url)}}})])})),e.errorMessage?n("p",[e._v(e._s(e.errorMessage))]):e._e(),n("div",{staticClass:"loader-wrapper"},[e.gettingImagesInProcess?n("LoaderComponent"):e._e()],1)],2)])])])},at=[],it=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loader"},[e._v(".")])},rt=[],st={name:"LoaderComponent",props:{color:{type:String,default:"black"}}},ot=st,lt=(0,N.Z)(ot,it,rt,!1,null,"08de508f",null),mt=lt.exports,ct={name:"ImageSearcher",components:{LoaderComponent:mt},data:function(){return{show:!1,popupId:null,searchTerm:"",images:[],continue:null,scrollListening:!1,gettingImagesInProcess:!1,errorMessage:null}},watch:{show:{handler:function(e){e&&(this.popupId||(this.popupId=Math.random()),this.state.openedPopups.push(this.popupId),document.addEventListener("keydown",this.handleEscKey))},immediate:!0}},methods:{toggleOpen:function(){this.show=!this.show},close:function(){this.show=!1},handleEscKey:function(e){var t=this;"Escape"===e.key&&this.$nextTick((function(){t.state.openedPopups[t.state.openedPopups.length-1]===t.popupId&&(document.removeEventListener("keydown",t.handleEscKey),t.close(),t.state.openedPopups.pop())}))},maybeClosePopup:function(e){e.target===this.$refs.wrapper&&this.close()},selectImage:function(e){this.$emit("selected",e),this.close()},getImages:function(){var e=this;this.gettingImagesInProcess=!0,O().get("".concat(window.location.origin,"/").concat(this.state.entry.dictId,"/getmedia/").concat(this.searchTerm,"/")).then((function(t){e.images=[],e.gettingImagesInProcess=!1,0!==t.data.images.length?(e.errorMessage=null,t.data.images.forEach((function(t){e.images.push({thumb:t.thumb,url:t.url})}))):e.errorMessage="No images found."})).catch((function(t){e.errorMessage=t.message}))}}},ut=ct,dt=(0,N.Z)(ut,nt,at,!1,null,"dc8502c0",null),pt=dt.exports,ht={name:"MediaComponent",components:{ImageSearcher:pt},props:{elementData:Object,elementName:String,content:{type:Object,required:!0}},mixins:[me,Ve,ce],computed:{isMultimediaAPI:function(){return!0}},data:function(){return{value:""}},mounted:function(){this.value=this.content.text},methods:{updateParent:function(){var e=this;this.$nextTick((function(){if(e.value!==e.content.text)if("attribute"===e.content.type)e.$emit("input",{elementName:e.elementName,attributes:(0,He.Z)({},e.content.name,e.value)});else{var t=Object.assign({},e.content);t.text=e.value,e.$emit("input",{elementName:e.elementName,elements:[t]})}}))},updateValue:function(e){this.value=e,this.updateParent()}}},ft=ht,vt=(0,N.Z)(ft,et,tt,!1,null,"afb1ec2a",null),gt=vt.exports,yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.elementData.shown&&!e.readOnly?n("section",{staticClass:"text-input"},[e.isAttribute?n("label",{staticClass:"text--md",attrs:{for:e.computedElementName}},[e._v(e._s(e.computedElementNameWithColon))]):e._e(),"textarea"===this.elementData.editorInputType?n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"},{name:"validate",rawName:"v-validate.continues",value:e.computedValidation,expression:"computedValidation",modifiers:{continues:!0}}],class:{error:e.errors.has(e.computedElementName||e.elementName)},attrs:{name:e.computedElementName||e.elementName,cols:"30",rows:"10",placeholder:e.errors&&e.errors.first(e.computedElementName||e.elementName)||e.computedElementName||e.elementName},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}}):"checkbox"===e.getInputType()?n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"},{name:"validate",rawName:"v-validate.continues",value:e.computedValidation,expression:"computedValidation",modifiers:{continues:!0}}],class:{error:e.errors.has(e.computedElementName||e.elementName)},attrs:{name:e.computedElementName||e.elementName,placeholder:e.errors&&e.errors.first(e.computedElementName||e.elementName)||e.computedElementName||e.elementName,type:"checkbox"},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{change:[function(t){var n=e.value,a=t.target,i=!!a.checked;if(Array.isArray(n)){var r=null,s=e._i(n,r);a.checked?s<0&&(e.value=n.concat([r])):s>-1&&(e.value=n.slice(0,s).concat(n.slice(s+1)))}else e.value=i},e.updateParent]}}):"radio"===e.getInputType()?n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"},{name:"validate",rawName:"v-validate.continues",value:e.computedValidation,expression:"computedValidation",modifiers:{continues:!0}}],class:{error:e.errors.has(e.computedElementName||e.elementName)},attrs:{name:e.computedElementName||e.elementName,placeholder:e.errors&&e.errors.first(e.computedElementName||e.elementName)||e.computedElementName||e.elementName,type:"radio"},domProps:{checked:e._q(e.value,null)},on:{change:[function(t){e.value=null},e.updateParent]}}):n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"},{name:"validate",rawName:"v-validate.continues",value:e.computedValidation,expression:"computedValidation",modifiers:{continues:!0}}],class:{error:e.errors.has(e.computedElementName||e.elementName)},attrs:{name:e.computedElementName||e.elementName,placeholder:e.errors&&e.errors.first(e.computedElementName||e.elementName)||e.computedElementName||e.elementName,type:e.getInputType()},domProps:{value:e.value},on:{change:e.updateParent,input:function(t){t.target.composing||(e.value=t.target.value)}}}),e.elementData.interactivity?n("button",{staticClass:"button--sm tertiary",staticStyle:{"margin-left":"8px"},on:{click:e.previewValue}},[e._v("Preview ")]):e._e()]):e._e(),e.elementData.shown&&e.readOnly?n("section",{staticClass:"read-only"},[n("p",{class:e.computedClass},[e._v(e._s(e.computedElementNameWithColon)+" ")]),n("span",{class:e.computedClass},[e._v(e._s(e.value))])]):e._e()])},Ct=[],bt={name:"TextInputComponent",inject:["$validator"],props:{elementData:Object,elementName:String,content:{type:Object,required:!0}},mixins:[me,Ve,ze],data:function(){return{value:""}},mounted:function(){this.value=this.content.text},methods:{updateParent:function(){var e=this;this.$nextTick((function(){if(e.value!==e.content.text)if("attribute"===e.content.type)e.$emit("input",{elementName:e.elementName,attributes:(0,He.Z)({},e.content.name,e.value)});else{var t=Object.assign({},e.content);t.text=e.value,e.$emit("input",{elementName:e.elementName,elements:[t]})}}))},previewValue:function(){window.open(this.value,"_blank")},getInputType:function(){switch(this.elementData.editorInputType){case"number":case"text":return this.elementData.editorInputType;default:return"text"}}}},xt=bt,Et=(0,N.Z)(xt,yt,Ct,!1,null,"43344832",null),Nt=Et.exports,wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.elementData.shown&&!e.readOnly?n("section",{staticClass:"input-section"},[e.isAttribute?n("label",{staticClass:"text--md"},[e._v(e._s(e.computedElementNameWithColon))]):e._e(),n("div",{ref:"wholeInput",staticClass:"text-with-markup"},e._l(e.values,(function(t,a){return n("span",{key:a+t.type,ref:a,refInFor:!0,class:e.calculatedClasses(t),staticStyle:{"white-space":"pre-wrap"},style:e.calculatedStyles(t),attrs:{"data-index":a,"data-type":t.type,"data-name":t.name||null,"data-text":t.text,role:"textbox",contenteditable:""},domProps:{innerHTML:e._s(t.text)},on:{focusout:e.updateValue}})})),0),n("div",{ref:"markActionButton",staticClass:"dropdown"},[n("button",{staticClass:"secondary mark-as",on:{click:e.toggleMarkActions}},[e._v("Mark as")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showMarkActions,expression:"showMarkActions"}],staticClass:"vue-dropdown-content"},e._l(e.markupElements,(function(t,a){return n("button",{key:a,staticClass:"tertiary",attrs:{disabled:t.disabled},on:{click:function(n){return e.markTextAs(t.type)}}},[e._v(e._s(t.type)+" ")])})),0)])]):e._e(),e.elementData.shown&&e.readOnly&&e.readOnlyValues.length>0?n("section",{staticClass:"read-only"},[n("p",{class:e.computedClass},[e._v(e._s(e.computedElementNameWithColon)+" ")]),n("span",{class:e.computedClass},e._l(e.readOnlyValues,(function(t,a){return n("span",{key:a+t.type,staticStyle:{"white-space":"pre-wrap"},domProps:{innerHTML:e._s(t.text)}})})),0)]):e._e()])},kt=[],_t=(n(8862),n(9714),{methods:{getStylesFromConfig:function(e){for(var t=this.state.entry.dictConfigs.xemplate[e],n={},a=0,i=Object.entries(t);a<i.length;a++){var r=(0,s.Z)(i[a],2),o=r[0],l=r[1];switch(o){case"background":n.backgroundColor=l;break;case"colour":n.color=l;break;case"slant":n.fontStyle=l;break;case"weight":n.fontWeight=l;break}}return n}}}),Ot={name:"TextInputWithMarkupComponent",props:{elementData:Object,elementName:String,content:{type:[Object,Array],required:!0},children:Array},mixins:[_t,me,Ve],computed:{readOnlyValues:function(){return this.values.filter((function(e){return e.text}))}},watch:{values:{handler:function(e){var t;Array.isArray(this.values)?(t=[],this.values.forEach((function(e){switch(e.type){case"text":""!==e.text&&t.push({type:"text",text:e.text});break;default:""!==e.text&&t.push({type:"element",name:e.name,elements:[{type:"text",text:e.text}]})}}))):(t=Object.assign({},this.content),t.text=""+e[0].text),JSON.stringify(t)!==JSON.stringify(this.content)&&this.$emit("input",{elementName:this.elementName,elements:t})},deep:!0},showMarkActions:function(e){e?window.addEventListener("click",this.watchForOutsideClick):window.removeEventListener("click",this.watchForOutsideClick)}},data:function(){return{values:[],markupElements:null,combinedValue:"",showMarkActions:!1}},created:function(){var e=this,t=this.state.entry.dictConfigs.xampl;this.markupElements=[{type:"text",disabled:!1}],Array.isArray(this.children)?this.children.forEach((function(t){t.isAttribute||e.markupElements.push({type:e.getElementNameInConfig(t.name),disabled:!1})})):this.markupElements=[{type:t.markup,disabled:!1}]},mounted:function(){this.computeValues()},methods:{getElementNameInConfig:function(e){var t=this.state.entry.dictConfigs.xema.elements,n=t[e];return n&&n.elementName||e},computeValues:function(){var e=this;Array.isArray(this.content)&&this.content.length>0?this.content.forEach((function(t,n){"text"===t.type?e.values.push({type:"text",text:t.text,index:n,name:null}):"element"===t.type&&e.values.push({type:t.type,name:t.name||null,text:e.findTextInElement(t.elements),index:n})})):this.values=[{type:"text",text:"",index:0,name:null}]},updateValue:function(e){this.values[e.target.dataset.index].text=e.target.textContent},findTextInElement:function(e){if(Array.isArray(e)){var t=e.find((function(e){return"text"===e.type}));return t.text||""}return""},calculatedStyles:function(e){switch(e.type){case"text":return this.getStylesFromConfig(this.elementName);case"element":return this.getStylesFromConfig(e.name)}},calculatedClasses:function(e){var t=[];return""===e.text&&t.push("empty-element"),"text"===e.type?t.push("text-element"):t.push("dynamic-element"),t},markTextAs:function(e){var t;this.showMarkActions=!1;var n=this.getSelection(),a=n.fromElement,i=n.start,r=n.end,s=n.selection;if(a&&s){var o=[];switch(0!==i&&o.push({type:a.dataset.type,text:a.textContent.substring(0,i),name:a.dataset.name||null}),e){case"text":o.push({type:"text",text:s,name:null});break;default:o.push({type:"element",text:s,name:e||null})}r!==a.textContent.length&&o.push({type:a.dataset.type,text:a.textContent.substring(r,a.textContent.length),name:a.dataset.name||null}),(t=this.values).splice.apply(t,[Number(a.dataset.index),1].concat(o)),this.tryMergingValues()}},tryMergingValues:function(){if(!(this.values.length<2))for(var e=0;e<this.values.length-1;e++){var t=this.values[e],n=this.values[e+1];if(t.type===n.type&&t.name===n.name){t.text+=n.text,this.values.splice(e,2,t),this.tryMergingValues();break}}},getSelection:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e,t,n,a=getSelection(),i=this.$refs["wholeInput"];if(a.rangeCount&&i.compareDocumentPosition((e=a.getRangeAt(0)).startContainer)!==Node.DOCUMENT_POSITION_PRECEDING&&i.compareDocumentPosition(e.endContainer)!==Node.DOCUMENT_POSITION_FOLLOWING){var r=a.focusNode.parentElement;return t=i.compareDocumentPosition(e.startContainer)===Node.DOCUMENT_POSITION_FOLLOWING?0:e.startOffset,n=i.compareDocumentPosition(e.endContainer)===Node.DOCUMENT_POSITION_PRECEDING?i.textContent.length:e.endOffset,a=r.textContent.substring(t,n),{fromElement:r,start:t,end:n,selection:a}}return{}})),toggleMarkActions:function(){this.showMarkActions=!this.showMarkActions},watchForOutsideClick:function(e){this.$refs.markActionButton&&!this.$refs.markActionButton.contains(e.target)&&this.toggleMarkActions()}}},St=Ot,Dt=(0,N.Z)(St,wt,kt,!1,null,"735f6768",null),Pt=Dt.exports;a.Z.config.productionTip=!1;var Tt=new a.Z;a.Z.use(Q.ZP,{mode:"eager"}),a.Z.component("InlineComponent",Ae),a.Z.component("PopupComponent",Ze),a.Z.component("ReadOnlyComponent",qe),a.Z.component("DropdownComponent",Ye),a.Z.component("MediaComponent",gt),a.Z.component("TextInputComponent",Nt),a.Z.component("TextInputWithMarkupComponent",Pt),a.Z.mixin({data:function(){return{bus:Tt,state:ie.state}}}),window.mountGraphicalEditor=function(){var e="editor";document.getElementById("editor")||(e="container"),window.editor=new a.Z({components:{App:ne},template:"<App/>"}),window.editor.$mount("#"+e)}}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,a,i,r){if(!a){var s=1/0;for(c=0;c<e.length;c++){a=e[c][0],i=e[c][1],r=e[c][2];for(var o=!0,l=0;l<a.length;l++)(!1&r||s>=r)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(o=!1,r<s&&(s=r));if(o){e.splice(c--,1);var m=i();void 0!==m&&(t=m)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,r,s=a[0],o=a[1],l=a[2],m=0;if(s.some((function(t){return 0!==e[t]}))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)var c=l(n)}for(t&&t(a);m<s.length;m++)r=s[m],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},a=self["webpackChunkeditor"]=self["webpackChunkeditor"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(5968)}));a=n.O(a)})();
//# sourceMappingURL=app-legacy.5cafa6fe.js.map